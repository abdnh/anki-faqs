# مجدول 2021

مجدول سنة 2021 ("v3") هو تحديث [لمجدول أنكي 2.1](./the-anki-2.1-scheduler.md) ("v2").
إنه حاليًا في المرحلة التجريبية.

## التوافق

مجدولا v2 وv3 متوافقان. تستطيع التنقل من واحد لآخر بدون مزامنة كاملة، ولن تحصل
مشاكل مزامنة إذا كنت تستخدم v3 على جهاز وv2 على جهاز آخر.

البرامج التي تدعمه:

- أنكي: 2.1.45+
- أنكي موبيل: 2.0.75+
- أنكي ويب: نعم
- أنكيدرويد: ليس بعد

قد يستغرق أنكيدرويد وقتًا حتى يدعم مجدول v3 بشكل مباشر. في الوقت الحاضر،
سيستمر بإظهار البطاقات باستخدام مجدول v2، بغض النظر عن الإعداد الذي اخترته.

لأن مجدول v3 يستخدم طريقة مختلفة لجمع البطاقات وفرزها، قد تظهر البرامج التي تدعم
v2 أو v3 عدد بطاقات مستحقة مختلفًا عن بعضها البعض في يوم معين. هذا لن يسبب مشاكل
في الجدولة، لكن يرجى أخذه بعين الاعتبار إذا كنت تتنقل من مجدول لآخر.

## التغييرات

### الاسترجاع

يستخدم مجدول v3 بنية الاسترجاع الجديدة في أنكي، حيث يمكنك الإجابة عن بطاقة،
ودفن بطاقة أخرى، والإجابة عن بطاقة أخرى، ثم التراجع عن كل خطوة بدورها.
المجدولات السابقة عاملت عمليات التراجع بشكل منفصل، حيث تمسح عملية ليست متعلقة بالدراسة سجل تراجعات الدراسة، والعكس صحيح.

### الحدود اليومية

حد البطاقات اليومي محدود بحد المراجعة الآن. إذا ضبطت حد المراجعة لـ200 مراجعة
وحد البطاقات الجديدة لـ20، وهناك 190 مراجعة مستحقة، فستظهر 10 بطاقات جديدة فقط.

في أنكي 2.1.50+ وأنكي موبيل 2.0.84+، يؤثر حد كل رزمة بعدد البطاقات التي يتم جلبها من تلك الرزمة ورزمها الفرعية.
يتم تطبيق الحدود بدءًا من الرزمة التي تحددها، لذلك إذا حددت رزمة فرعية، فلن تنطبق حدود الرزمة الأم عليها. على سبيل المثال، إذا كانت لدينا الحدود التالية:

- أم: 100
- أم::طفل: 30
- أم::طفل::حفيد1: 50
- أم::طفل::حفيد2: 5
- أم::طفل::حفيد3: 200

عندها:

- إذا ضغطت على **حفيد3**، فستظهر 200 بطاقة كحد أقصى.
- إذا ضغطت على **حفيد2**، فستظهر 5 بطاقات كحد أقصى.
- إذا ضغطت على **حفيد1**، فستظهر 50 بطاقة كحد أقصى.
- إذا ضغطت على **طفل**، فستظهر 30 بطاقة كحد أقصى من رزمة **طفل** ورزمها الفرعية.
  ولن يظهر أكثر من 5 بطاقات من **حفيد2**.
- إذا ضغطت على **أم**، فستظهر 100 بطاقة كحد أقصى، مع 30 بطاقة كحد أقصى من رزمة **طفل** ورزمها الفرعية.

في مجدول v3 في الإصدارات السابقة، لم تكن الحدود الأقرب لكل رزمة تؤخذ بعين الاعتبار،
بمعنى أنك إذا ضغطت على **أم**، لم تكن حدود **طفل** تؤثر على عدد البطاقات المأخوذة من الأحفاد.

### الفرز

أضيفت خيارات رزمة إضافية للتحكم بترتيب البطاقات الجديدة والمراجعات. يمكن خلط البطاقات الجديدة وجلبها من رزم مختلفة، ويمكن ترتيب المراجعات حسب الفاصل الزمني أو الرزم الفرعية.

عندما يكون الدفن غير مفعل، أصبح الآن من الممكن التحكم بما إذا كان يجب إظهار البطاقات
الشقيقة معًا أم لا عن طريق ضبط ترتيب الظهور.

تم نقل الخيارات التي تتحكم بخلط البطاقات الجديدة وبطاقات التعلم ذات الخطوات التي لا تتخطى اليوم الواحد من شاشة التفضيلات إلى خيارات الرزمة. تنطبق إعدادات الرزمة التي تختارها.

### الدفن

عندما يكون الدفن مفعلًا، يتم إقصاء البطاقات من صفوف الدراسة في بداية جلسة الدراسة.
سابقًا إذا كان لديك 10 بطاقات أمام-خلف و10 بطاقات خلف-أمام، كانت تبدأ العدادات من 20 وتتناقص أثناء المراجعة، لكن الآن ستبدأ من العدد 10.
ما زال يحدث الدفن الفعلي أثناء مراجعتك للبطاقات.

لأن الإقصاء يحدث عندما تضغط على رزمة، فقد تختلف الأعداد التي تراها في شاشة الرزم
عن الأعداد التي تراها عندما تضغط على رزمة. تظهر شاشة موجز الرزمة عدد البطاقات التي سيتم دفنها.

يمكن الآن دفن بطاقات التعلم التي تتخطى خطواتها اليوم الواحد مثل المراجعات والبطاقات الجديدة، وأصبح هناك خيار جديد للتحكم بما إذا كان يجب دفنها أم لا.

### العامل العشوائي

يؤثر الآن العامل العشوائي المضاف إلى المراجعات بالفواصل الظاهرة على أزرار الإجابة،
بدلًا من السلوك القديم الذي كان يطبق العامل فقط عندما تجيب عن البطاقة.

كما تم تحسين طريقة حساب الفاصل: البطاقات ذات الفواصل الأقصر من أسبوع تأخذ
فواصل متوازنة أكثر، وطول الفاصل يزداد بانتظام أكثر كلما طالت الفواصل.

### بطاقات التعلم ذات الخطوات التي تتخطى اليوم الواحد

بطاقات التعلم ذات الخطوات التي تتخطى اليوم الواحد تخضع لحد المراجعة الآن.
عند تحديد البطاقات التي تتسع في الحد المضبوط، أنكي يجلب هذا النوع من البطاقات أولًا، ثم
المراجعات، وأخيرًا البطاقات الجديدة.

### الرزم المفلترة

تظهر الآن الرزم المفلترة حينما يكون خيار إعادة الجدولة غير مفعل 4 أزرار:
الفاصل المعطى ينطبق على زر مجددًا، بينما تطبق أزرار صعب/جيد 1.5 و2 أضعاف ذاك الفاصل.
بينما زر سهل يزيل البطاقة من الرزمة المفلترة.

## الإضافات والجدولة المخصصة

تمت كتابة المجدول الجديد من الصفر، لذلك لن تعمل أي إضافات تعدل جلب البطاقات
ودوال الإجابة في المجدول القديم. لم يعد ممكنًا أيضا استبدال أجزاء من كود المجدول
("monkey
patching")، لذلك ليس عمليًا إعادة كتابة بعض الإضافات لتعمل مع المجدول الجديد بدون جهد كبير.

لكن المجدول الجديد يوفر بعض التحكم بالجدولة على كل حال. كلما يتم عرض بطاقة،
تكون الفواصل والحالات المرتبطة بكل زر إجابة محسوبة مسبقًا، ومن الممكن تغيير
الجدولة المحسوبة باستخدام كود جافاسكربت يتم إدخاله أسفل شاشة خيارات الرزمة.

مثلًا:

```javascript
// اطبع الحالات الموجودة
console.log(JSON.stringify(states, null, 4));

// افتح متتبع الأخطاء إذا كان فاحص الويب مفتوحًا
debugger;

// إذا كان زر صعب في خطوة تعلم، اجعل فاصله
// 123 دقيقة
if (states.hard.normal?.learning) {
  states.hard.normal.learning.scheduledSecs = 123 * 60;
}

// طبق التغيير نفسه في زرمة مفلترة فيها خيار إعادة الجدولة مفعل
if (states.hard.filtered?.rescheduling?.originalState?.learning) {
  states.hard.filtered.rescheduling.originalState.learning.scheduledSecs =
    123 * 60;
}

// ارفع عامل السهولة بقيمة 0.2 عندما يتم ضغط زر سهل في بطاقة مراجعة
if (states.good.normal?.review) {
  states.easy.normal.review.easeFactor =
    states.good.normal.review.easeFactor + 0.2;
}
```

لأن هذا مكتوب بلغة جافاسكربت، فإنه ليس محدودًا على نسخة الكمبيوتر فقط:
أنكي موبيل يدعمه أيضا، وقد يدعمه أنكي ويب وأنكيدرويد في المستقبل أيضًا.
سيسمح هذا للمستخدمين المتقدمين بإجراء تغييرات على سلوك الجدولة العادي بطريقة
تعمل على كل المنصات.

حالات الجدولة المختلفة مشروحة [هنا](https://github.com/ankitects/anki/blob/9edac805adfe285cc92ed04dfeeffc1d1813c4d0/rslib/backend.proto#L1454).

## الاستقرارية

نجح المجدول الجديد بتخطي معظم الاختبارات المستخدمة لاختبار المجدولات القديمة
(في الحالات التي يكون فيها سلوك المجدولات متطابقًا)، وقد تلقى انطباعات جيدة حتى الآن،
لكن من الممكن وجود سلوكات غير اعتيادية لم يتم الكشف عنها بعد.
يرجى إعلامنا إذا لاحظت أي شيء غير عادي.

## تجربة المجدول

بدءًا من أنكي 2.1.45 وأنكي موبيل 2.0.75، يمكن تفعيل المجدول وتعطيله من شاشة التفضيلات.
